<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CYBER VAULT | NEURAL SYSTEM v8.0</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;800&display=swap" rel="stylesheet">
    <!-- Phosphor Icons for cleaner icons -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <!-- Model Viewer for 3D Models -->
    <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.3.0/model-viewer.min.js"></script>
    <!-- Highlight.js for syntax highlighting -->
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <link rel="stylesheet" href="src/styles/main.css">
</head>

<body>

    <div class="grid-floor" id="floor"></div>
    <div class="crt-overlay"></div>

    <!-- Main Interface -->
    <div class="viewport-container" id="dashboard">
        <aside class="sidebar">
            <div class="logo" id="logoBtn">
                CYBER VAULT
                <div style="font-size:9px; color:#555; margin-left:auto;">[NEURAL]</div>
            </div>
            <div class="nav-list" id="navList"></div>
        </aside>

        <main class="main">
            <header class="header">
                <div class="page-title" id="pageTitle">仪表盘<span class="page-subtitle" id="pageSubtitle">/
                        在线</span></div>
                <div style="display: flex; gap: 15px; align-items: center;">
                    <div class="search-box" id="searchBox">
                        <input type="text" id="searchInput" placeholder="搜索数据库..." autocomplete="off">
                        <div class="search-suggestions" id="searchSuggestions"></div>
                    </div>
                    <!-- Upload / User Profile Trigger -->
                    <div class="user-profile-box" onclick="openUploadPanel()" title="上传资源">
                        <i class="ph ph-upload-simple"></i>
                    </div>
                    <div class="user-profile-box" onclick="openEditor()" title="撰写文章"
                        style="border-color: var(--c-green); color: var(--c-green);">
                        <i class="ph ph-pencil-simple"></i>
                    </div>
                </div>
            </header>

            <div class="toolbar">
                <div class="filter-group" id="filterContainer"></div>
                <div style="display: flex; align-items: center; gap: 10px; font-size: 11px; color: #666;">
                    <span>ZOOM_LENS</span>
                    <input type="range" id="zoomSlider" min="0.8" max="1.3" value="1" step="0.1"
                        style="width: 100px; accent-color: var(--accent);">
                </div>
            </div>

            <div class="grid-content" id="grid"></div>
        </main>
    </div>

    <!-- NEURAL GRAPH MODE CONTAINER -->
    <div class="graph-container" id="graphView">
        <canvas id="particleCanvas"></canvas>
        <!-- SVG injected here -->

        <div class="neural-settings-panel">
            <div
                style="font-size:14px; font-weight:bold; color:#fff; border-bottom:1px solid #333; padding-bottom:10px; margin-bottom:10px;">
                NEURAL_CONTROLS
            </div>

            <div class="setting-group">
                <div class="setting-label"><span>图片尺寸</span><span id="valSize">40px</span></div>
                <input type="range" id="setImgSize" min="20" max="100" value="40" oninput="updateGraphSettings()">
            </div>

            <div class="setting-group">
                <div class="setting-label"><span>DENSITY</span><span id="valDensity">ALL</span></div>
                <input type="range" id="setDensity" min="10" max="100" value="100" oninput="updateGraphSettings()">
            </div>

            <div class="setting-group">
                <div class="setting-label"><span>VISUALS</span></div>
                <label class="filter-checkbox">
                    <input type="checkbox" id="setShowImages" checked onchange="updateGraphSettings()">
                    SHOW IMAGES
                </label>
                <label class="filter-checkbox">
                    <input type="checkbox" id="setParticles" checked onchange="toggleParticles()">
                    COSMIC PARTICLES
                </label>
            </div>

            <div class="setting-group">
                <div class="setting-label"><span>FILTER NODES</span></div>
                <div id="filterChecks"></div>
            </div>

            <div class="setting-group">
                <div class="setting-label"><span>BG COLOR</span></div>
                <input type="color" id="setBgColor" value="#1a1a2e"
                    style="width:100%; border:none; height:25px; cursor:pointer;" onchange="updateGraphBg()">
            </div>

            <div class="exit-neural-btn">退出系统</div>
        </div>
    </div>

    <!-- Modal -->
    <div class="modal-overlay" id="modal">
        <div class="modal-panel" id="modalPanel">
            <div class="close-btn">×</div>
            <div class="expand-btn">全屏</div>

            <div class="modal-gallery">
                <div class="card-scan" style="opacity: 0.15; z-index: 10; pointer-events: none;"></div>

                <!-- Fixed Loading Bar -->
                <div class="cyber-loader" id="mediaLoader">
                    <div class="loader-box">
                        <div class="loader-text-row">
                            <span>数据加载中...</span>
                            <span id="loadPercent">0%</span>
                        </div>
                        <div class="loader-bar-container">
                            <div class="loader-fill" id="loadBar"></div>
                        </div>
                    </div>
                </div>

                <div class="nav-btn prev" id="btnPrev" onclick="navigateMedia(-1)" style="display:none;">
                    <div class="arrow-graphic"></div>
                </div>
                <div class="nav-btn next" id="btnNext" onclick="navigateMedia(1)" style="display:none;">
                    <div class="arrow-graphic"></div>
                </div>
                <div class="main-view" id="mediaContainer"></div>
                <div class="thumb-strip" id="thumbStrip"></div>
            </div>

            <div class="modal-info">
                <div style="color:var(--accent); font-size:11px; letter-spacing:2px; margin-bottom:8px;">机密资源</div>
                <div style="font-size:24px; font-weight:800; line-height:1.2; color:#fff; text-shadow: 0 0 10px rgba(255,255,255,0.2); margin-bottom: 20px; word-break: break-all;"
                    id="modalTitle">标题</div>
                <div
                    style="display:grid; grid-template-columns: 1fr 1fr; gap: 20px; border-top:1px solid rgba(255,255,255,0.1); padding-top:20px;">
                    <div>
                        <div style="color:#666; font-size:10px;">大小</div>
                        <div class="stat-val" id="modalSize" style="margin-left:0; font-size:14px;">0MB</div>
                    </div>
                    <div>
                        <div style="color:#666; font-size:10px;">版本</div>
                        <div class="stat-val" id="modalVer" style="margin-left:0; font-size:14px;">v.1.0</div>
                    </div>
                    <div>
                        <div style="color:#666; font-size:10px;">状态</div>
                        <div style="color:var(--c-green); font-weight:bold; font-size:14px;">启用</div>
                    </div>
                    <div>
                        <div style="color:#666; font-size:10px;">格式</div>
                        <div class="stat-val" id="modalType" style="margin-left:0; font-size:14px; color:#fff;">资源
                        </div>
                    </div>
                </div>
                <div style="margin-top:20px; font-size:12px; color:#888; line-height:1.6; flex:1; overflow-y:auto;"
                    id="modalDesc">
                    <p style="margin-bottom:10px;">> Analyzing packet header...</p>
                    <p>Asset verified. Security checksum valid. Contains high-resolution visual data and telemetry logs
                        from the targeted sector.</p>
                </div>
                <div class="cyber-btn" id="btnStartDownload">开始下载</div>

                <!-- DOWNLOAD PANEL (Overlay inside modal) -->
                <div class="download-panel" id="downloadPanel">
                    <div class="dl-header">
                        <span>// 选择版本</span>
                        <span class="dl-close" id="closeDownloadPanel">×</span>
                    </div>
                    <div class="dl-content" id="dlContent">
                        <!-- Dynamic Content will be injected here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Upload Panel -->
    <!-- Upload Panel (Redesigned) -->
    <div class="upload-panel" id="uploadPanel">
        <div class="up-header">
            <span>// 上传数据包</span>
            <span style="cursor:pointer; color:var(--c-alert);" onclick="closeUploadPanel()">×</span>
        </div>

        <div class="upload-grid">
            <!-- LEFT: FORM -->
            <div class="up-left-col">
                <div class="form-group">
                    <div class="form-label">标题</div>
                    <input type="text" id="upTitle" class="cyber-input" placeholder="自动从文件名提取"
                        oninput="updatePreview()">
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top:20px;">
                    <div class="form-group">
                        <div class="form-label">分类</div>
                        <select id="upCategory" class="cyber-input"
                            onchange="updateSubCats(); updatePreview();"></select>
                    </div>
                    <div class="form-group">
                        <div class="form-label">子分类</div>
                        <select id="upSub" class="cyber-input" onchange="updatePreview()"></select>
                    </div>
                </div>

                <div class="form-group" style="margin-top:20px;">
                    <div class="form-label">描述（加密日志）</div>
                    <textarea id="upDesc" class="cyber-input" style="height: 80px; resize: none;" placeholder="请输入简介..."
                        oninput="updatePreview()"></textarea>
                </div>

                <div class="form-group" style="margin-top:20px;">
                    <div class="form-label">标签（用逗号分隔）</div>
                    <input type="text" id="upTags" class="cyber-input" placeholder="科幻, 安全, 数据..."
                        oninput="updatePreview()">
                </div>

                <div class="form-group" style="margin-top:20px;">
                    <div class="form-label">封面图片</div>
                    <div class="cover-uploader" id="coverDrop" onclick="document.getElementById('coverInput').click()">
                        <span>点击设置封面</span>
                        <input type="file" id="coverInput" style="display:none" accept="image/*"
                            onchange="handleCoverSelect(this)">
                    </div>
                </div>

                <div class="form-group" style="margin-top:20px;">
                    <div class="file-drop-zone" id="mainDropZone"
                        onclick="document.getElementById('fileInput').click()">
                        <i class="ph ph-cloud-arrow-up"
                            style="color:var(--accent); font-size: 32px; text-shadow: 0 0 10px var(--accent);"></i>
                        <span style="margin-top:10px; color:#fff;">点击上传资源</span>
                        <span style="font-size:10px; color:#666; margin-top:5px;">JPG, PNG, WEBP（最大 5MB）</span>
                        <input type="file" id="fileInput" style="display:none" multiple
                            onchange="handleFileSelect(this)">
                    </div>
                </div>
            </div>

            <!-- RIGHT: PREVIEW -->
            <div class="up-right-col">
                <div class="preview-label">// 实时预览 v9.0</div>

                <!-- CARD MOCKUP -->
                <div class="preview-card" id="previewCard">
                    <div class="card-type-badge" id="preType">资源</div>
                    <div class="preview-cover">
                        <div class="card-scan"></div>
                        <img id="preImg" src="https://placehold.co/600x400/000/00f3ff?text=暂无预览" style="opacity: 0.8;">
                    </div>
                    <div class="preview-body">
                        <div class="preview-title" id="preTitle">未命名资源</div>
                        <div class="preview-tags" id="preTags">
                            <span class="tag-pill">新建</span>
                        </div>
                        <div class="preview-meta">
                            <div class="pre-size">大小 <span id="preSize" style="color:#fff;">0 MB</span></div>
                            <div class="pre-ver">版本 <span style="color:#fff;">v1.0</span></div>
                        </div>
                    </div>
                </div>

                <!-- FILE LIST -->
                <div class="preview-label" style="margin-top:20px;">// 批量队列</div>
                <div class="file-list" id="fileList">
                    <div style="text-align:center; color:#444; padding:20px; font-size:10px;">未选择文件</div>
                </div>
            </div>
        </div>

        <div class="up-footer">
            <div class="cyber-btn"
                style="width:100px; font-size:11px; padding:10px; background:transparent; color:#888; border-color:#444;"
                onclick="closeUploadPanel()">取消</div>
            <div class="cyber-btn" style="width:140px; font-size:11px; padding:10px;" onclick="submitUpload()">
                <i class="ph ph-upload-simple"></i> 开始上传
            </div>
        </div>
    </div>

    <!-- Article Editor Panel -->
    <div class="editor-panel" id="editorPanel">
        <div class="editor-header">
            <div style="font-size: 18px; font-weight: bold; letter-spacing: 2px; color: var(--accent);">
                <span>//</span> 神经写作系统
            </div>
            <div style="display:flex; gap: 20px; align-items:center;">
                <div class="editor-stats" id="editorStats">
                    <span class="stat-item">字数: <b id="statWords">0</b></span>
                    <span class="stat-item">图片: <b id="statImg">0</b></span>
                </div>
                <div style="font-size: 10px; color: #666;">状态: <span style="color:var(--c-green)">在线</span>
                </div>
                <div class="cyber-btn" onclick="closeEditor()"
                    style="width:auto; padding: 5px 15px; font-size: 12px; background: transparent; border-color: var(--c-alert); color: var(--c-alert);">
                    退出</div>
            </div>
        </div>

        <div class="editor-toolbar">
            <!-- Font Size -->
            <div class="toolbar-dropdown">
                <div class="dropdown-btn" onclick="event.stopPropagation(); toggleDropdown('fontSizeDropdown', event)">
                    字号 <i class="ph ph-caret-down"></i>
                </div>
                <div class="dropdown-content" id="fontSizeDropdown">
                    <div class="dropdown-item" onclick="execCmd('fontSize', '1')">小</div>
                    <div class="dropdown-item" onclick="execCmd('fontSize', '3')">中</div>
                    <div class="dropdown-item" onclick="execCmd('fontSize', '5')">大</div>
                    <div class="dropdown-item" onclick="execCmd('fontSize', '7')">特大</div>
                </div>
            </div>

            <!-- Color Format -->
            <div class="toolbar-dropdown">
                <div class="dropdown-btn" onclick="event.stopPropagation(); toggleDropdown('colorDropdown', event)">
                    Color <i class="ph ph-caret-down"></i>
                </div>
                <div class="dropdown-content" id="colorDropdown">
                    <div class="color-picker-panel">
                        <div class="color-tabs">
                            <div class="color-tab active" onclick="switchColorTab('fore')">Text</div>
                            <div class="color-tab" onclick="switchColorTab('back')">Highlight</div>
                        </div>
                        <div id="foreColorGrid" class="color-grid"></div>
                        <div id="backColorGrid" class="color-grid" style="display:none;"></div>
                        <div class="recent-colors">
                            <div style="font-size:9px; color:#666; margin-bottom:5px;">RECENT</div>
                            <div id="recentColors" class="color-grid" style="grid-template-columns: repeat(8, 1fr);">
                            </div>
                        </div>
                        <div class="dropdown-item" onclick="execCmd('removeFormat'); toggleDropdown('colorDropdown')"
                            style="margin-top:5px; justify-content:center; background:rgba(255,0,0,0.1); color:#ff5555;">
                            <i class="ph ph-eraser" style="margin-right:5px;"></i> Remove Color
                        </div>
                    </div>
                </div>
            </div>

            <div class="tool-separator"></div>

            <button class="tool-btn" data-cmd="bold" onclick="execCmd('bold')" title="Bold (Ctrl+B)"><b>B</b></button>
            <button class="tool-btn" data-cmd="italic" onclick="execCmd('italic')"
                title="Italic (Ctrl+I)"><i>I</i></button>
            <button class="tool-btn" data-cmd="underline" onclick="execCmd('underline')"
                title="Underline (Ctrl+U)"><u>U</u></button>
            <button class="tool-btn" data-cmd="strikeThrough" onclick="execCmd('strikeThrough')"
                title="Strikethrough"><s>S</s></button>

            <div class="tool-separator"></div>

            <button class="tool-btn" data-cmd="justifyLeft" onclick="execCmd('justifyLeft')" title="Align Left"><i
                    class="ph ph-text-align-left"></i></button>
            <button class="tool-btn" data-cmd="justifyCenter" onclick="execCmd('justifyCenter')" title="Align Center"><i
                    class="ph ph-text-align-center"></i></button>
            <button class="tool-btn" data-cmd="justifyRight" onclick="execCmd('justifyRight')" title="Align Right"><i
                    class="ph ph-text-align-right"></i></button>

            <div class="tool-separator"></div>

            <button class="tool-btn" data-cmd="insertUnorderedList" onclick="execCmd('insertUnorderedList')"
                title="Bullet List"><i class="ph ph-list-bullets"></i></button>
            <button class="tool-btn" data-cmd="insertOrderedList" onclick="execCmd('insertOrderedList')"
                title="Numbered List"><i class="ph ph-list-numbers"></i></button>
            <button class="tool-btn" onclick="execCmd('formatBlock', 'blockquote')" title="Quote"><i
                    class="ph ph-quotes"></i></button>
            <button class="tool-btn" onclick="insertCodeBlock()" title="Code Block"><i class="ph ph-code"></i></button>
            <button class="tool-btn" onclick="insertHorizontalRule()" title="Horizontal Line"><i
                    class="ph ph-minus"></i></button>

            <div class="tool-separator"></div>

            <button class="tool-btn" onclick="showTablePanel()" title="Insert Table"><i
                    class="ph ph-table"></i></button>
            <button class="tool-btn" onclick="showLinkPanel()" title="Link"><i class="ph ph-link"></i></button>
            <button class="tool-btn" onclick="triggerFileUpload('image')" title="Insert Image"><i
                    class="ph ph-image"></i></button>
            <button class="tool-btn" onclick="triggerFileUpload('video')" title="Insert Video"><i
                    class="ph ph-film-strip"></i></button>

            <div class="tool-separator"></div>
            <div class="tool-separator"></div>

            <button class="tool-btn" onclick="execCmd('undo')" title="Undo (Ctrl+Z)"><i
                    class="ph ph-arrow-u-up-left"></i></button>
            <button class="tool-btn" onclick="execCmd('redo')" title="Redo (Ctrl+Y)"><i
                    class="ph ph-arrow-u-up-right"></i></button>

            <div class="tool-separator"></div>

            <button class="tool-btn" id="btnSource" onclick="toggleSourceMode()" title="Source Code"><i
                    class="ph ph-code-block"></i></button>



            <!-- Inputs for file upload -->
            <input type="file" id="editorImgInput" style="display:none;" accept="image/*"
                onchange="handleEditorUpload(this, 'image')">
            <input type="file" id="editorVidInput" style="display:none;" accept="video/*"
                onchange="handleEditorUpload(this, 'video')">
        </div>

        <div class="editor-workspace">
            <div class="editor-main">
                <div class="editor-content" id="editorContent" contenteditable="true" spellcheck="false"
                    oninput="updateStats()">
                    <p><br></p>
                </div>
                <textarea class="editor-source" id="editorSource" spellcheck="false"></textarea>
                <div class="editor-source-highlight" id="editorSourceHighlight"></div>
                <div class="floating-toolbar" id="floatingToolbar">
                    <button class="tool-btn" onclick="execCmd('bold')" title="Bold"><b>B</b></button>
                    <button class="tool-btn" onclick="execCmd('italic')" title="Italic"><i>I</i></button>
                    <button class="tool-btn" onclick="execCmd('underline')" title="Underline"><u>U</u></button>
                    <button class="tool-btn" onclick="execCmd('foreColor', '#00f3ff')" title="Cyan Highlight"
                        style="color:#00f3ff;"><b>A</b></button>
                    <button class="tool-btn" onclick="execCmd('foreColor', '#ff0055')" title="Pink Highlight"
                        style="color:#ff0055;"><b>A</b></button>
                    <button class="tool-btn" onclick="execCmd('backColor', 'rgba(0, 243, 255, 0.2)')" title="Marker"
                        style="color:#00f3ff;"><i class="ph ph-highlighter"></i></button>
                    <button class="tool-btn" onclick="execCmd('backColor', 'rgba(255, 0, 85, 0.2)')" title="Marker"
                        style="color:#ff0055;"><i class="ph ph-highlighter"></i></button>
                    <div class="tool-separator"></div>
                    <button class="tool-btn" onclick="showLinkPanel()" title="Link"><i class="ph ph-link"></i></button>
                </div>

                <!-- Inline Link Panel -->
                <div class="link-panel" id="linkPanel">
                    <input type="text" class="link-input" id="linkInput" placeholder="https://...">
                    <button class="tool-btn" onclick="confirmLink()"><i class="ph ph-check"></i></button>
                    <button class="tool-btn" onclick="hideLinkPanel()"><i class="ph ph-x"></i></button>
                </div>

                <!-- Table Panel -->
                <div class="table-panel" id="tablePanel">
                    <div style="font-size: 10px; color: var(--accent); margin-bottom: 10px;">表格尺寸</div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px;">
                        <div>
                            <label style="font-size: 9px; color: #888;">行数</label>
                            <input type="number" id="tableRows" value="3" min="1" max="20"
                                style="width: 100%; padding: 5px; background: rgba(0,0,0,0.5); border: 1px solid #444; color: #fff;">
                        </div>
                        <div>
                            <label style="font-size: 9px; color: #888;">列数</label>
                            <input type="number" id="tableCols" value="3" min="1" max="20"
                                style="width: 100%; padding: 5px; background: rgba(0,0,0,0.5); border: 1px solid #444; color: #fff;">
                        </div>
                    </div>
                    <button class="tool-btn" onclick="insertTable()" style="width: 100%; margin-bottom: 5px;"><i
                            class="ph ph-check"></i> 插入</button>
                    <button class="tool-btn" onclick="hideTablePanel()"
                        style="width: 100%; background: rgba(255,0,85,0.2); border-color: #ff0055; color: #ff0055;"><i
                            class="ph ph-x"></i> 取消</button>
                </div>

                <!-- Table Toolbar (shown when table is selected) -->
                <div class="table-toolbar" id="tableToolbar">
                    <button class="tool-btn" onclick="tableAddRow('above')" title="Add Row Above"><i
                            class="ph ph-arrow-up"></i></button>
                    <button class="tool-btn" onclick="tableAddRow('below')" title="Add Row Below"><i
                            class="ph ph-arrow-down"></i></button>
                    <button class="tool-btn" onclick="tableAddCol('left')" title="Add Column Left"><i
                            class="ph ph-arrow-left"></i></button>
                    <button class="tool-btn" onclick="tableAddCol('right')" title="Add Column Right"><i
                            class="ph ph-arrow-right"></i></button>
                    <div class="tool-separator"></div>
                    <button class="tool-btn" onclick="tableDeleteRow()" title="Delete Row"><i
                            class="ph ph-minus"></i></button>
                    <button class="tool-btn" onclick="tableDeleteCol()" title="Delete Column"
                        style="font-weight: bold;">|</button>
                    <button class="tool-btn" onclick="tableDeleteTable()" title="Delete Table"
                        style="color: var(--c-alert);"><i class="ph ph-trash"></i></button>
                </div>

                <!-- Table Context Menu (right-click menu) -->
                <div class="table-context-menu" id="tableContextMenu">
                    <div class="context-menu-section">
                        <div class="context-menu-title">ROW HEIGHT</div>
                        <input type="number" id="tableRowHeight" value="30" min="20" max="200"
                            style="width: 100%; padding: 5px; background: rgba(0,0,0,0.5); border: 1px solid #444; color: #fff; margin-bottom: 10px;">
                        <button class="tool-btn" onclick="applyTableRowHeight()"
                            style="width: 100%; margin-bottom: 15px;">APPLY</button>
                    </div>

                    <div class="context-menu-section">
                        <div class="context-menu-title">COLUMN WIDTH</div>
                        <input type="number" id="tableColWidth" value="100" min="50" max="500"
                            style="width: 100%; padding: 5px; background: rgba(0,0,0,0.5); border: 1px solid #444; color: #fff; margin-bottom: 10px;">
                        <button class="tool-btn" onclick="applyTableColWidth()"
                            style="width: 100%; margin-bottom: 15px;">APPLY</button>
                    </div>

                    <div class="context-menu-section">
                        <div class="context-menu-title">TEXT ALIGN</div>
                        <div style="display: flex; gap: 5px; margin-bottom: 10px;">
                            <button class="tool-btn" onclick="setTableCellAlign('left', 'cell')" title="Cell Left"><i
                                    class="ph ph-text-align-left"></i></button>
                            <button class="tool-btn" onclick="setTableCellAlign('center', 'cell')"
                                title="Cell Center"><i class="ph ph-text-align-center"></i></button>
                            <button class="tool-btn" onclick="setTableCellAlign('right', 'cell')" title="Cell Right"><i
                                    class="ph ph-text-align-right"></i></button>
                        </div>
                        <div style="display: flex; gap: 5px;">
                            <button class="tool-btn" onclick="setTableCellAlign('left', 'row')" title="Row Left"
                                style="font-size: 9px;">ROW</button>
                            <button class="tool-btn" onclick="setTableCellAlign('center', 'row')" title="Row Center"
                                style="font-size: 9px;">ROW</button>
                            <button class="tool-btn" onclick="setTableCellAlign('right', 'row')" title="Row Right"
                                style="font-size: 9px;">ROW</button>
                        </div>
                    </div>

                    <div class="context-menu-section">
                        <div class="context-menu-title">CELL BACKGROUND</div>
                        <div class="color-picker-grid" id="tableColorPicker"
                            style="display: grid; grid-template-columns: repeat(8, 1fr); gap: 5px; margin-bottom: 10px;">
                            <!-- Colors will be generated by JS -->
                        </div>
                        <input type="color" id="tableCustomColor" value="#000000"
                            style="width: 100%; height: 30px; margin-bottom: 10px; cursor: pointer;">
                        <button class="tool-btn" onclick="applyTableCellColor()" style="width: 100%;">APPLY
                            COLOR</button>
                    </div>
                </div>

                <!-- Resizer Overlay -->
                <div class="resizer-overlay" id="resizeOverlay">
                    <div class="resize-handle rh-nw" data-corner="nw"></div>
                    <div class="resize-handle rh-ne" data-corner="ne"></div>
                    <div class="resize-handle rh-sw" data-corner="sw"></div>
                    <div class="resize-handle rh-se" data-corner="se"></div>

                    <div class="media-tools">
                        <button class="tool-btn" onclick="setMediaAlign('left')" title="Float Left"><i
                                class="ph ph-text-align-left"></i></button>
                        <button class="tool-btn" onclick="setMediaAlign('center')" title="Center"><i
                                class="ph ph-text-align-center"></i></button>
                        <button class="tool-btn" onclick="setMediaAlign('right')" title="Float Right"><i
                                class="ph ph-text-align-right"></i></button>
                        <button class="tool-btn" onclick="setMediaAlign('inline')" title="Inline"><i
                                class="ph ph-placeholder"></i></button>
                        <button class="tool-btn" onclick="deleteSelectedMedia()" title="Delete"
                            style="color:var(--c-alert);"><i class="ph ph-trash"></i></button>
                    </div>
                </div>
            </div>

            <div class="editor-sidebar">
                <div
                    style="color: var(--accent); font-size: 12px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 10px; margin-bottom: 10px;">
                    // 元数据配置
                </div>

                <div>
                    <label style="font-size: 10px; color: #888; display: block; margin-bottom: 5px;">标题</label>
                    <input type="text" id="artTitle" placeholder="文章标题...">
                </div>

                <div>
                    <label style="font-size: 10px; color: #888; display: block; margin-bottom: 5px;">分类</label>
                    <select id="artCategory">
                        <option value="blog-articles">博客 / 文章</option>
                        <option value="blog-notes">博客 / 笔记</option>
                        <!-- Should be dynamically populated ideally, but hardcoded for now -->
                    </select>
                </div>

                <div>
                    <label style="font-size: 10px; color: #888; display: block; margin-bottom: 5px;">标签</label>
                    <input type="text" id="artTags" placeholder="科幻, 神经, 日志...">
                </div>

                <div>
                    <label style="font-size: 10px; color: #888; display: block; margin-bottom: 5px;">封面（可选）</label>
                    <div class="cover-uploader" id="artCoverDrop"
                        onclick="document.getElementById('artCoverInput').click()" style="margin-top: 5px;">
                        <span id="artCoverText">点击上传封面</span>
                        <input type="file" id="artCoverInput" style="display:none" accept="image/*"
                            onchange="handleArticleCoverSelect(this)">
                    </div>
                    <div id="artCoverPreview" style="margin-top: 10px; display: none;">
                        <img id="artCoverPreviewImg"
                            style="max-width: 100%; max-height: 150px; border: 1px solid var(--accent);">
                        <button onclick="clearArticleCover()"
                            style="margin-top: 5px; padding: 5px 10px; background: rgba(255,0,85,0.2); border: 1px solid #ff0055; color: #ff0055; cursor: pointer; font-size: 10px;">移除</button>
                    </div>
                </div>

                <div style="margin-top: auto;">
                    <div class="cyber-btn" onclick="handlePublish()" style="width: 100%; text-align: center;">
                        <i class="ph ph-paper-plane-right"></i> PUBLISH_TO_GRID
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="src/main.js"></script>
</body>

</html>